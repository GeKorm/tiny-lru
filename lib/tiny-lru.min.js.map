{"version":3,"sources":["tiny-lru.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","max","arguments","undefined","LRU","next","process","nextTick","arg","setTimeout","keys","Reflect","ownKeys","this","notify","reset","value","silent","onchange","dump","remove","JSON","stringify","has","last","output","cache","set","k","toString","cached","previous","first","create","item","_this","obj","parse","forEach","exports","module","define","amd","lru","window"],"mappings":"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","file":"tiny-lru.min.js","sourcesContent":["/**\r\n * Tiny LRU cache for Client or Server\r\n *\r\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\r\n * @copyright 2017\r\n * @license BSD-3-Clause\r\n * @link https://github.com/avoidwork/tiny-lru\r\n * @version 1.4.10\r\n */\n\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (global) {\n\tvar next = typeof process !== \"undefined\" ? process.nextTick : function (arg) {\n\t\treturn setTimeout(arg, 1);\n\t},\n\t    keys = typeof Reflect !== \"undefined\" ? Reflect.ownKeys : Object.keys;\n\n\tvar LRU = function () {\n\t\tfunction LRU(max) {\n\t\t\t_classCallCheck(this, LRU);\n\n\t\t\tthis.max = max;\n\t\t\tthis.notify = false;\n\n\t\t\treturn this.reset();\n\t\t}\n\n\t\t_createClass(LRU, [{\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tvar silent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n\t\t\t\tthis.reset();\n\n\t\t\t\tif (!silent && this.notify) {\n\t\t\t\t\tnext(this.onchange(\"clear\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"delete\",\n\t\t\tvalue: function _delete(key) {\n\t\t\t\tvar silent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n\t\t\t\treturn this.remove(key, silent);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dump\",\n\t\t\tvalue: function dump() {\n\t\t\t\treturn JSON.stringify(this, null, 0);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"evict\",\n\t\t\tvalue: function evict() {\n\t\t\t\tif (this.has(this.last)) {\n\t\t\t\t\tthis.remove(this.last, true);\n\t\t\t\t}\n\n\t\t\t\tif (this.notify) {\n\t\t\t\t\tnext(this.onchange(\"evict\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"get\",\n\t\t\tvalue: function get(key) {\n\t\t\t\tvar output = void 0;\n\n\t\t\t\tif (this.has(key)) {\n\t\t\t\t\toutput = this.cache[key].value;\n\t\t\t\t\tthis.set(key, output);\n\n\t\t\t\t\tif (this.notify) {\n\t\t\t\t\t\tnext(this.onchange(\"get\", this.dump()));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"has\",\n\t\t\tvalue: function has(key) {\n\t\t\t\treturn key in this.cache;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"onchange\",\n\t\t\tvalue: function onchange() {}\n\t\t}, {\n\t\t\tkey: \"remove\",\n\t\t\tvalue: function remove(k) {\n\t\t\t\tvar silent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n\t\t\t\tvar key = typeof k !== \"string\" ? k.toString() : k,\n\t\t\t\t    cached = this.cache[key];\n\n\t\t\t\tif (cached) {\n\t\t\t\t\tdelete this.cache[key];\n\t\t\t\t\tthis.length--;\n\n\t\t\t\t\tif (this.has(cached.previous)) {\n\t\t\t\t\t\tthis.cache[cached.previous].next = cached.next;\n\n\t\t\t\t\t\tif (this.first === key) {\n\t\t\t\t\t\t\tthis.first = cached.previous;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.first === key) {\n\t\t\t\t\t\tthis.first = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.has(cached.next)) {\n\t\t\t\t\t\tthis.cache[cached.next].previous = cached.previous;\n\n\t\t\t\t\t\tif (this.last === key) {\n\t\t\t\t\t\t\tthis.last = cached.next;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.last === key) {\n\t\t\t\t\t\tthis.last = null;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (this.first === key) {\n\t\t\t\t\t\tthis.first = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.last === key) {\n\t\t\t\t\t\tthis.last = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!silent && this.notify) {\n\t\t\t\t\tnext(this.onchange(\"remove\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn cached;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {\n\t\t\t\tthis.cache = Object.create(null);\n\t\t\t\tthis.first = null;\n\t\t\t\tthis.last = null;\n\t\t\t\tthis.length = 0;\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"set\",\n\t\t\tvalue: function set(key, value) {\n\t\t\t\tvar first = void 0,\n\t\t\t\t    item = void 0;\n\n\t\t\t\tif (this.has(key)) {\n\t\t\t\t\titem = this.cache[key];\n\t\t\t\t\titem.value = value;\n\t\t\t\t\titem.next = null;\n\t\t\t\t\titem.previous = this.first !== key ? this.first : null;\n\n\t\t\t\t\tif (this.last === key && item.previous !== null) {\n\t\t\t\t\t\tthis.last = item.previous;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (++this.length > this.max) {\n\t\t\t\t\t\tthis.remove(this.last, true);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.length === 1) {\n\t\t\t\t\t\tthis.last = key;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cache[key] = {\n\t\t\t\t\t\tnext: null,\n\t\t\t\t\t\tprevious: this.first,\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (this.first !== key && this.has(this.first)) {\n\t\t\t\t\tfirst = this.cache[this.first];\n\t\t\t\t\tfirst.next = key;\n\n\t\t\t\t\tif (first.previous === key) {\n\t\t\t\t\t\tfirst.previous = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.first = key;\n\n\t\t\t\tif (this.notify) {\n\t\t\t\t\tnext(this.onchange(\"set\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"update\",\n\t\t\tvalue: function update(arg) {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tvar obj = JSON.parse(arg);\n\n\t\t\t\tkeys(obj).forEach(function (i) {\n\t\t\t\t\t_this[i] = obj[i];\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\n\t\treturn LRU;\n\t}();\n\n\tfunction factory() {\n\t\tvar max = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1000;\n\n\t\treturn new LRU(max);\n\t}\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\n\t\tdefine(function () {\n\t\t\treturn factory;\n\t\t});\n\t} else {\n\t\tglobal.lru = factory;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}