{"version":3,"sources":["tiny-lru.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","max","arguments","undefined","LRU","this","cache","first","last","value","arg","output","JSON","parse","stringify","remove","string","clone","cached","set","_this","obj","keys","forEach","previous","next","evict","exports","module","define","amd","lru","window"],"mappings":"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","file":"tiny-lru.min.js","sourcesContent":["\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * Tiny LRU cache for Client or Server\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2016\n * @license BSD-3-Clause\n * @link https://github.com/avoidwork/tiny-lru\n * @version 1.2.1\n */\n(function (global) {\n\tvar LRU = function () {\n\t\tfunction LRU(max) {\n\t\t\t_classCallCheck(this, LRU);\n\n\t\t\tthis.cache = {};\n\t\t\tthis.max = max;\n\t\t\tthis.first = null;\n\t\t\tthis.last = null;\n\t\t\tthis.length = 0;\n\t\t}\n\n\t\t_createClass(LRU, [{\n\t\t\tkey: \"clone\",\n\t\t\tvalue: function clone(arg) {\n\t\t\t\tvar output = void 0;\n\n\t\t\t\tif (typeof arg !== \"function\") {\n\t\t\t\t\toutput = JSON.parse(JSON.stringify(arg, null, 0));\n\t\t\t\t} else {\n\t\t\t\t\toutput = arg;\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"delete\",\n\t\t\tvalue: function _delete(key) {\n\t\t\t\treturn this.remove(key);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"evict\",\n\t\t\tvalue: function evict() {\n\t\t\t\tif (this.last !== null) {\n\t\t\t\t\tthis.remove(this.last);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dump\",\n\t\t\tvalue: function dump() {\n\t\t\t\tvar string = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n\t\t\t\treturn string ? JSON.stringify(this, null, 0) : this.clone(this);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"get\",\n\t\t\tvalue: function get(key) {\n\t\t\t\tvar cached = this.cache[key],\n\t\t\t\t    output = void 0;\n\n\t\t\t\tif (cached) {\n\t\t\t\t\toutput = this.clone(cached.value);\n\t\t\t\t\tthis.set(key, cached.value);\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"has\",\n\t\t\tvalue: function has(key) {\n\t\t\t\treturn this.cache[key] !== undefined;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"merge\",\n\t\t\tvalue: function merge() {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tvar arg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"{}\";\n\n\t\t\t\tvar obj = typeof arg === \"string\" ? JSON.parse(arg) : this.clone(arg);\n\n\t\t\t\tObject.keys(obj).forEach(function (i) {\n\t\t\t\t\t_this[i] = obj[i];\n\t\t\t\t});\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"remove\",\n\t\t\tvalue: function remove(key) {\n\t\t\t\tvar cached = this.cache[key];\n\n\t\t\t\tif (cached) {\n\t\t\t\t\tdelete this.cache[key];\n\t\t\t\t\tthis.length--;\n\n\t\t\t\t\tif (cached.previous !== null) {\n\t\t\t\t\t\tthis.cache[cached.previous].next = cached.next;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (cached.next !== null) {\n\t\t\t\t\t\tthis.cache[cached.next].previous = cached.previous;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.first === key) {\n\t\t\t\t\t\tthis.first = cached.previous;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.last === key) {\n\t\t\t\t\t\tthis.last = cached.next;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn cached;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"set\",\n\t\t\tvalue: function set(key, value) {\n\t\t\t\tvar obj = this.remove(key);\n\n\t\t\t\tif (!obj) {\n\t\t\t\t\tobj = {\n\t\t\t\t\t\tnext: null,\n\t\t\t\t\t\tprevious: null,\n\t\t\t\t\t\tvalue: this.clone(value)\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tobj.value = this.clone(value);\n\t\t\t\t}\n\n\t\t\t\tobj.next = null;\n\t\t\t\tobj.previous = this.first;\n\t\t\t\tthis.cache[key] = obj;\n\n\t\t\t\tif (this.first) {\n\t\t\t\t\tthis.cache[this.first].next = key;\n\t\t\t\t}\n\n\t\t\t\tthis.first = key;\n\n\t\t\t\tif (!this.last) {\n\t\t\t\t\tthis.last = key;\n\t\t\t\t}\n\n\t\t\t\tif (++this.length > this.max) {\n\t\t\t\t\tthis.evict();\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}]);\n\n\t\treturn LRU;\n\t}();\n\n\tfunction factory() {\n\t\tvar max = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1000;\n\n\t\treturn new LRU(max);\n\t}\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd) {\n\t\tdefine(function () {\n\t\t\treturn factory;\n\t\t});\n\t} else {\n\t\tglobal.lru = factory;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}