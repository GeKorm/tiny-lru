{"version":3,"sources":["tiny-lru.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","global","factory","max","arguments","undefined","notify","ttl","expire","LRU","next","process","nextTick","arg","setTimeout","empty","this","reset","value","silent","onchange","dump","col","has","clearTimeout","remove","obj","JSON","parse","stringify","timers","last","output","cache","set","clearTimer","setTimer","k","toString","result","cached","previous","first","_this","expires","keys","forEach","item","setExpire","_this2","_this3","_this4","exports","module","define","amd","lru","window"],"mappings":"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","file":"tiny-lru.min.js","sourcesContent":["/**\n * Tiny LRU cache for Client or Server\n *\n * @author Jason Mulligan <jason.mulligan@avoidwork.com>\n * @copyright 2018\n * @license BSD-3-Clause\n * @link https://github.com/avoidwork/tiny-lru\n * @version 1.6.1\n */\n\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function (global) {\n\tvar next = typeof process !== \"undefined\" ? process.nextTick : function (arg) {\n\t\treturn setTimeout(arg, 1);\n\t},\n\t    empty = \"\";\n\n\tvar LRU = function () {\n\t\tfunction LRU(max, notify, ttl, expire) {\n\t\t\t_classCallCheck(this, LRU);\n\n\t\t\tthis.expire = expire;\n\t\t\tthis.max = max;\n\t\t\tthis.notify = notify;\n\t\t\tthis.ttl = ttl;\n\n\t\t\treturn this.reset();\n\t\t}\n\n\t\t_createClass(LRU, [{\n\t\t\tkey: \"clear\",\n\t\t\tvalue: function clear() {\n\t\t\t\tvar silent = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n\t\t\t\tthis.reset();\n\n\t\t\t\tif (!silent && this.notify) {\n\t\t\t\t\tnext(this.onchange(\"clear\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"clearTimer\",\n\t\t\tvalue: function clearTimer(key) {\n\t\t\t\tvar col = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"timers\";\n\n\t\t\t\tif (this.has(key, col)) {\n\t\t\t\t\tclearTimeout(this[col][key]);\n\t\t\t\t\tdelete this[col][key];\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"delete\",\n\t\t\tvalue: function _delete(key) {\n\t\t\t\tvar silent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n\t\t\t\treturn this.remove(key, silent);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"dump\",\n\t\t\tvalue: function dump() {\n\t\t\t\tvar obj = JSON.parse(JSON.stringify(this));\n\n\t\t\t\tdelete obj.timers;\n\n\t\t\t\treturn JSON.stringify(obj);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"evict\",\n\t\t\tvalue: function evict() {\n\t\t\t\tif (this.has(this.last)) {\n\t\t\t\t\tthis.remove(this.last, true);\n\t\t\t\t}\n\n\t\t\t\tif (this.notify) {\n\t\t\t\t\tnext(this.onchange(\"evict\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"get\",\n\t\t\tvalue: function get(key) {\n\t\t\t\tvar output = void 0;\n\n\t\t\t\tif (this.has(key)) {\n\t\t\t\t\toutput = this.cache[key].value;\n\t\t\t\t\tthis.set(key, output);\n\n\t\t\t\t\tif (this.notify) {\n\t\t\t\t\t\tnext(this.onchange(\"get\", this.dump()));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.ttl > 0) {\n\t\t\t\t\t\tthis.clearTimer(key).setTimer(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn output;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"has\",\n\t\t\tvalue: function has(key) {\n\t\t\t\tvar type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"cache\";\n\n\t\t\t\treturn key in this[type];\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"onchange\",\n\t\t\tvalue: function onchange() {}\n\t\t}, {\n\t\t\tkey: \"remove\",\n\t\t\tvalue: function remove(k) {\n\t\t\t\tvar silent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n\t\t\t\tvar key = typeof k !== \"string\" ? k.toString() : k,\n\t\t\t\t    result = void 0;\n\n\t\t\t\tif (this.has(key)) {\n\t\t\t\t\tvar cached = this.cache[key];\n\n\t\t\t\t\tdelete this.cache[key];\n\t\t\t\t\tthis.length--;\n\n\t\t\t\t\tif (this.ttl > 0) {\n\t\t\t\t\t\tthis.clearTimer(key);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (silent === false && this.expire > 0) {\n\t\t\t\t\t\tthis.clearTimer(key, \"expires\");\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.has(cached.previous)) {\n\t\t\t\t\t\tthis.cache[cached.previous].next = cached.next;\n\n\t\t\t\t\t\tif (this.first === key) {\n\t\t\t\t\t\t\tthis.first = cached.previous;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.first === key) {\n\t\t\t\t\t\tthis.first = empty;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.has(cached.next)) {\n\t\t\t\t\t\tthis.cache[cached.next].previous = cached.previous;\n\n\t\t\t\t\t\tif (this.last === key) {\n\t\t\t\t\t\t\tthis.last = cached.next;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.last === key) {\n\t\t\t\t\t\tthis.last = empty;\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = cached;\n\t\t\t\t} else {\n\t\t\t\t\tif (this.first === key) {\n\t\t\t\t\t\tthis.first = empty;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.last === key) {\n\t\t\t\t\t\tthis.last = empty;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!silent && this.notify) {\n\t\t\t\t\tnext(this.onchange(\"remove\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"reset\",\n\t\t\tvalue: function reset() {\n\t\t\t\tvar _this = this;\n\n\t\t\t\tif (this.expires !== void 0) {\n\t\t\t\t\tObject.keys(this.expires).forEach(function (i) {\n\t\t\t\t\t\treturn _this.clearTimer(i, \"expires\");\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this.timers !== void 0) {\n\t\t\t\t\tObject.keys(this.timers).forEach(function (i) {\n\t\t\t\t\t\treturn _this.clearTimer(i);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.cache = {};\n\t\t\t\tthis.expires = {};\n\t\t\t\tthis.first = empty;\n\t\t\t\tthis.last = empty;\n\t\t\t\tthis.length = 0;\n\t\t\t\tthis.timers = {};\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"set\",\n\t\t\tvalue: function set(key, value) {\n\t\t\t\tvar first = void 0,\n\t\t\t\t    item = void 0;\n\n\t\t\t\tif (this.has(key)) {\n\t\t\t\t\titem = this.cache[key];\n\t\t\t\t\titem.value = value;\n\t\t\t\t\titem.next = empty;\n\n\t\t\t\t\tif (this.first !== key) {\n\t\t\t\t\t\titem.previous = this.first;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.last === key && item.previous !== empty) {\n\t\t\t\t\t\tthis.last = item.previous;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (++this.length > this.max) {\n\t\t\t\t\t\tthis.remove(this.last, true);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.length === 1) {\n\t\t\t\t\t\tthis.last = key;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cache[key] = {\n\t\t\t\t\t\tnext: empty,\n\t\t\t\t\t\tprevious: this.first,\n\t\t\t\t\t\tvalue: value\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (this.first !== key && this.has(this.first)) {\n\t\t\t\t\tfirst = this.cache[this.first];\n\t\t\t\t\tfirst.next = key;\n\n\t\t\t\t\tif (first.previous === key) {\n\t\t\t\t\t\tfirst.previous = empty;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.first = key;\n\n\t\t\t\tif (this.notify) {\n\t\t\t\t\tnext(this.onchange(\"set\", this.dump()));\n\t\t\t\t}\n\n\t\t\t\tif (this.ttl > 0) {\n\t\t\t\t\tthis.clearTimer(key).setTimer(key);\n\t\t\t\t}\n\n\t\t\t\tif (this.expire > 0 && this.has(key, \"expires\") === false) {\n\t\t\t\t\tthis.setExpire(key);\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setExpire\",\n\t\t\tvalue: function setExpire(key) {\n\t\t\t\tvar _this2 = this;\n\n\t\t\t\tthis.expires[key] = setTimeout(function () {\n\t\t\t\t\treturn _this2.clearTimer(key, \"expires\").clearTimer(key).remove(key);\n\t\t\t\t}, this.expire);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"setTimer\",\n\t\t\tvalue: function setTimer(key) {\n\t\t\t\tvar _this3 = this;\n\n\t\t\t\tthis.timers[key] = setTimeout(function () {\n\t\t\t\t\treturn _this3.remove(key);\n\t\t\t\t}, this.ttl);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"update\",\n\t\t\tvalue: function update(arg) {\n\t\t\t\tvar _this4 = this;\n\n\t\t\t\tvar obj = JSON.parse(arg);\n\n\t\t\t\tObject.keys(obj).forEach(function (i) {\n\t\t\t\t\t_this4[i] = obj[i];\n\t\t\t\t});\n\t\t\t}\n\t\t}]);\n\n\t\treturn LRU;\n\t}();\n\n\tfunction factory() {\n\t\tvar max = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1000;\n\t\tvar notify = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\tvar ttl = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\t\tvar expire = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n\t\treturn new LRU(max, notify, ttl, expire);\n\t}\n\n\t// Node, AMD & window supported\n\tif (typeof exports !== \"undefined\") {\n\t\tmodule.exports = factory;\n\t} else if (typeof define === \"function\" && define.amd !== void 0) {\n\t\tdefine(function () {\n\t\t\treturn factory;\n\t\t});\n\t} else {\n\t\tglobal.lru = factory;\n\t}\n})(typeof window !== \"undefined\" ? window : global);\n"]}