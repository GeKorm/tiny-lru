/*
 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 4.0.5
*/
"use strict";(function(a){function b(c,d,e,a){c[e]=d,c[a]===d&&(c[a]=f)}function c(){return this.cache={},this.first=f,this.last=f,this.length=0,this}function d(a=1e3,b=!1,c=0){return new g(a,b,c)}const e="undefined"==typeof process?(a)=>setTimeout(a,1):process.nextTick,f=null;class g{constructor(a,b,d){this.max=a,this.notify=b,this.ttl=d,c.call(this)}clear(a=!1){return c.call(this),!1===a&&!0===this.notify&&e(this.onchange("clear",this.dump())),this}delete(a,b=!1){return this.remove(a,b)}dump(){return JSON.stringify({cache:this.cache,first:this.first,last:this.last,length:this.length,max:this.max,notify:this.notify,ttl:this.ttl})}evict(){return this.remove(this.last,!0,!0),!0===this.notify&&e(this.onchange("evict",this.dump())),this}get(a,b=!1){let c;if(!0===this.has(a)){const d=this.cache[a];-1===d.expiry||d.expiry>Date.now()?(c=d.value,this.set(a,c,!0,!0),!1===b&&!0===this.notify&&e(this.onchange("get",this.dump()))):this.remove(a)}return c}has(a){return a in this.cache}onchange(){}remove(a,b=!1,c=!1){let d;return(!0===c||!0===this.has(a))&&(d=this.cache[a],delete this.cache[a],this.length--,d.previous!==f&&(this.cache[d.previous].next=d.next),d.next!==f&&(this.cache[d.next].previous=d.previous),this.first===a&&(this.first=d.previous),this.last===a&&(this.last=d.next),!1===b&&!0===this.notify&&e(this.onchange("remove",this.dump()))),d}set(a,c,d=!1,g=!1){if(!0===g||!0===this.has(a)){const d=this.cache[a];if(d.value=c,this.first!==a){const c=d.next,e=d.previous;d.next=f,d.previous=this.first,b(this.cache[this.first],a,"next","previous"),c!==f&&c!==this.first&&(e!==f&&(this.cache[e].next=c),this.cache[c].previous=e),this.last===a&&(this.last=d.previous)}}else this.length===this.max&&this.evict(),this.length++,this.cache[a]={expiry:0<this.ttl?new Date().getTime()+this.ttl:-1,next:f,previous:this.first,value:c},1===this.length&&(this.last=a),this.first!==f&&this.first!==a&&b(this.cache[this.first],a,"next","previous");return this.first=a,!1===d&&!0===this.notify&&e(this.onchange("set",this.dump())),this}update(a){const b=JSON.parse(a);Object.keys(b).forEach((a)=>{this[a]=b[a]})}}"undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>d):a.lru=d:module.exports=d})("undefined"==typeof window?global:window);
//# sourceMappingURL=tiny-lru.min.js.map