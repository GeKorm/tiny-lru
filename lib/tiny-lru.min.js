/*
 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 2.0.1
*/
"use strict";(function(a){function b(a=1e3,b=!1,c=0,d=0){return new e(a,b,c,d)}const c="undefined"==typeof process?(a)=>setTimeout(a,1):process.nextTick,d="";class e{constructor(a,b,c,d){return this.expire=d,this.max=a,this.notify=b,this.ttl=c,this.reset()}clear(a=!1){return this.reset(),!a&&this.notify&&c(this.onchange("clear",this.dump())),this}clearTimer(a,b="timers"){return this.has(a,b)&&(clearTimeout(this[b][a]),delete this[b][a]),this}delete(a,b=!1){return this.remove(a,b)}dump(){return JSON.stringify({cache:this.cache,expire:this.expire,first:this.first,last:this.last,length:this.length,max:this.max,notify:this.notify,ttl:this.ttl})}evict(){return this.remove(this.last,!0),this.notify&&c(this.onchange("evict",this.dump())),this}get(a){let b;return this.has(a)&&(b=this.cache[a].value,this.set(a,b),0<this.ttl&&this.clearTimer(a).setTimer(a),this.notify&&c(this.onchange("get",this.dump()))),b}has(a,b="cache"){return a in this[b]}onchange(){}remove(a,b=!1){let e;if(this.has(a)){const b=this.cache[a];delete this.cache[a],this.length--,0<this.ttl&&this.clearTimer(a),0<this.expire&&this.clearTimer(a,"expires"),this.has(b.previous)?(this.cache[b.previous].next=b.next,this.first===a&&(this.first=b.previous)):this.first===a&&(this.first=d),this.has(b.next)?(this.cache[b.next].previous=b.previous,this.last===a&&(this.last=b.next)):this.last===a&&(this.last=d),e=b}return!b&&this.notify&&c(this.onchange("remove",this.dump())),e}reset(){return void 0!==this.expires&&Object.keys(this.expires).forEach((a)=>this.clearTimer(a,"expires")),void 0!==this.timers&&Object.keys(this.timers).forEach((a)=>this.clearTimer(a)),this.cache={},this.expires={},this.first=d,this.last=d,this.length=0,this.timers={},this}set(a,b){let e,f;return this.has(a)?(f=this.cache[a],f.value=b,f.next=d,this.first!==a&&(f.previous=this.first),this.last===a&&f.previous!==d&&(this.last=f.previous)):(++this.length>this.max&&this.remove(this.last,!0),1===this.length&&(this.last=a),this.cache[a]={next:d,previous:this.first,value:b}),this.first!==a&&this.has(this.first)&&(e=this.cache[this.first],e.next=a,e.previous===a&&(e.previous=d)),this.first=a,this.notify&&c(this.onchange("set",this.dump())),0<this.ttl&&this.clearTimer(a).setTimer(a),0<this.expire&&!1===this.has(a,"expires")&&this.setExpire(a),this}setExpire(a){this.expires[a]=setTimeout(()=>this.clearTimer(a,"expires").clearTimer(a).remove(a),this.expire)}setTimer(a){this.timers[a]=setTimeout(()=>this.remove(a),this.ttl)}update(a){const b=JSON.parse(a);Object.keys(b).forEach((a)=>{this[a]=b[a]})}}"undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>b):a.lru=b:module.exports=b})("undefined"==typeof window?global:window);
//# sourceMappingURL=tiny-lru.min.js.map