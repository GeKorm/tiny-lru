/*
 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 3.0.5
*/
"use strict";(function(a){function b(a=1e3,b=!1,c=0){return new e(a,b,c)}const c="undefined"==typeof process?(a)=>setTimeout(a,1):process.nextTick,d=null;class e{constructor(a,b,c){return this.max=a,this.notify=b,this.ttl=c,this.reset()}clear(a=!1){return this.reset(),!1===a&&!0===this.notify&&c(this.onchange("clear",this.dump())),this}delete(a,b=!1){return this.remove(a,b)}dump(){return JSON.stringify({cache:this.cache,first:this.first,last:this.last,length:this.length,max:this.max,notify:this.notify,ttl:this.ttl})}evict(){return this.remove(this.last,!0,!0),!0===this.notify&&c(this.onchange("evict",this.dump())),this}get(a,b=!1){let d;if(!0===this.has(a)){const e=this.cache[a];-1===e.expiry||e.expiry>Date.now()?(d=e.value,this.set(a,d,!0,!0),!1===b&&!0===this.notify&&c(this.onchange("get",this.dump()))):this.remove(a)}return d}has(a){return a in this.cache}onchange(){}remove(a,b=!1,e=!1){let f;return(!0===e||!0===this.has(a))&&(f=this.cache[a],delete this.cache[a],this.length--,f.previous===d?this.first===a&&(this.first=d):(this.cache[f.previous].next=f.next===a?d:f.next,this.first===a&&(this.first=f.previous)),f.next===d?this.last===a&&(this.last=d):(this.cache[f.next].previous=f.previous===a?d:f.previous,this.last===a&&(this.last=f.next)),!1===b&&!0===this.notify&&c(this.onchange("remove",this.dump()))),f}reset(){return this.cache={},this.first=d,this.last=d,this.length=0,this}set(a,b,e=!1,f=!1){if(!0===f||!0===this.has(a)){const c=this.cache[a];c.value=b,c.next=d,this.first!==a&&(c.previous=this.first),this.last===a&&c.previous!==d&&(this.last=c.previous)}else this.length===this.max&&this.evict(),this.length++,this.cache[a]={expiry:0<this.ttl?new Date().getTime()+this.ttl:-1,next:d,previous:this.first,value:b},1===this.length&&(this.last=a);if(this.first!==d&&this.first!==a){const b=this.cache[this.first];b.next=a,b.previous===a&&(b.previous=d)}return this.first=a,!1===e&&!0===this.notify&&c(this.onchange("set",this.dump())),this}update(a){const b=JSON.parse(a);Object.keys(b).forEach((a)=>{this[a]=b[a]})}}"undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>b):a.lru=b:module.exports=b})("undefined"==typeof window?global:window);
//# sourceMappingURL=tiny-lru.min.js.map