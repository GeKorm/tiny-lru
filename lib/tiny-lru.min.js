/*
 2018 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 4.0.1
*/
"use strict";(function(a){function b(){return this.cache={},this.first=e,this.last=e,this.length=0,this}function c(a=1e3,b=!1,c=0){return new f(a,b,c)}const d="undefined"==typeof process?(a)=>setTimeout(a,1):process.nextTick,e=null;class f{constructor(a,c,d){this.max=a,this.notify=c,this.ttl=d,b.call(this)}clear(a=!1){return b.call(this),!1===a&&!0===this.notify&&d(this.onchange("clear",this.dump())),this}delete(a,b=!1){return this.remove(a,b)}dump(){return JSON.stringify({cache:this.cache,first:this.first,last:this.last,length:this.length,max:this.max,notify:this.notify,ttl:this.ttl})}evict(){return this.remove(this.last,!0,!0),!0===this.notify&&d(this.onchange("evict",this.dump())),this}get(a,b=!1){let c;if(!0===this.has(a)){const e=this.cache[a];-1===e.expiry||e.expiry>Date.now()?(c=e.value,this.set(a,c,!0,!0),!1===b&&!0===this.notify&&d(this.onchange("get",this.dump()))):this.remove(a)}return c}has(a){return a in this.cache}onchange(){}remove(a,b=!1,c=!1){let f;return(!0===c||!0===this.has(a))&&(f=this.cache[a],delete this.cache[a],this.length--,f.previous!==e&&(this.cache[f.previous].next=f.next),f.next!==e&&(this.cache[f.next].previous=f.previous),this.first===a&&(this.first=f.previous),this.last===a&&(this.last=f.next),!1===b&&!0===this.notify&&d(this.onchange("remove",this.dump()))),f}set(a,b,c=!1,f=!1){if(!0===f||!0===this.has(a)){const c=this.cache[a];c.value=b,c.next=e,this.first!==a&&(c.previous=this.first),this.last===a&&c.previous!==e&&(this.last=c.previous)}else this.length===this.max&&this.evict(),this.length++,this.cache[a]={expiry:0<this.ttl?new Date().getTime()+this.ttl:-1,next:e,previous:this.first,value:b},1===this.length&&(this.last=a);if(this.first!==e&&this.first!==a){const b=this.cache[this.first];b.next=a,b.previous===a&&(b.previous=e)}return this.first=a,!1===c&&!0===this.notify&&d(this.onchange("set",this.dump())),this}update(a){const b=JSON.parse(a);Object.keys(b).forEach((a)=>{this[a]=b[a]})}}"undefined"==typeof exports?"function"==typeof define&&void 0!==define.amd?define(()=>c):a.lru=c:module.exports=c})("undefined"==typeof window?global:window);
//# sourceMappingURL=tiny-lru.min.js.map