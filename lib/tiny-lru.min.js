/* 2017 Jason Mulligan <jason.mulligan@avoidwork.com> */

"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();!function(a){function b(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new LRU(a)}var c="undefined"!=typeof process?process.nextTick:function(a){return setTimeout(a,1)},LRU=function(){function LRU(a){var b=this;_classCallCheck(this,LRU),this.cache={},this.first=null,this.last=null,this.length=0,this.max=a,this.notify=!1,this.onchange=function(){},this.update=function(a){var c=JSON.parse(a);Object.keys(c).forEach(function(a){b[a]=c[a]})}}return _createClass(LRU,[{key:"clear",value:function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.cache={},this.first=null,this.last=null,this.length=0,!a&&this.notify&&c(this.onchange("clear",this.dump()))}},{key:"delete",value:function(a){return this.remove(a)}},{key:"dump",value:function(){return JSON.stringify(this,null,0)}},{key:"evict",value:function(){return null!==this.last&&this.remove(this.last,!0),this.notify&&c(this.onchange("evict",this.dump())),this}},{key:"get",value:function(a){var b=this.cache[a],d=void 0;return b&&(d=b.value,this.set(a,b.value)),this.notify&&c(this.onchange("get",this.dump())),d}},{key:"has",value:function(a){return void 0!==this.cache[a]}},{key:"remove",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],d=this.cache[a];return d&&(delete this.cache[a],this.length--,null!==d.previous&&(this.cache[d.previous].next=d.next),null!==d.next&&(this.cache[d.next].previous=d.previous),this.first===a&&(this.first=d.previous),this.last===a&&(this.last=d.next)),!b&&this.notify&&c(this.onchange("remove",this.dump())),d}},{key:"set",value:function(a,b){var d=this.remove(a,!0);return d?d.value=b:d={next:null,previous:null,value:b},d.next=null,d.previous=this.first,this.cache[a]=d,this.first&&(this.cache[this.first].next=a),this.first=a,this.last||(this.last=a),++this.length>this.max&&this.evict(),this.notify&&c(this.onchange("set",this.dump())),this}}]),LRU}();"undefined"!=typeof exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):a.lru=b}("undefined"!=typeof window?window:global);
//# sourceMappingURL=tiny-lru.min.js.map